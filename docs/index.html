<html>
    <head>
        <title>Boombox</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        <style>
            body, html {
                padding: 0;
                margin: 0;
                width: 100%;
                height: 100%;
                -webkit-user-select: none;
                user-select: none;
            }
            #target {
                width: 100%;
                height: 100%;
                position: absolute;
            }
            .common-message {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 20px;
            }
        </style>
        <link rel="stylesheet" href="js/common.css"/>
        <script src="js/three.min.js"></script>
        <script src="https://threejs.org/examples/js/loaders/OBJLoader.js"></script>
        <script type="module" src="polyfill/XRPolyfill.js"></script>
        <script src="js/common.js"></script>
    </head>
    <body>
    <div id="target" />
    <div onclick="hideMe(this)" id="description">
        <h2>Boombox</h2>
        <h5>(click to dismiss)</h5>
        <p>Shows a boombox in a VR environment.</p>
    </div>
        <script>
            /*
            ARSimplestExample shows how to populate the content scene 
            */            
            class ARSimplestExample extends XRExampleBase {
                constructor(domElement){
                    super(domElement, false)
                }

                // Called during construction to allow the app to populate the THREE.Scene
                initializeScene(){
                    // Add a box on the floor
                    const box = new THREE.Mesh(
                        new THREE.BoxBufferGeometry(0.1, 0.1, 0.1),
                        new THREE.MeshPhongMaterial({ color: '#DDFFDD' })
                    )
                    box.position.set(0, 0, 0)
                    this.floorGroup.add(box)

                    this.scene.background = new THREE.Color(0x222222)
                    var self = this;

                    var manager = new THREE.LoadingManager();
                    var loader = new THREE.OBJLoader( manager );
                    loader.load( 'apartment.obj', function ( object ) {
                        object.scale.set(0.15, 0.15, 0.15)
                        object.position.set(0, 1, 3.2);
                        self.floorGroup.add( object );
                    } );


/*
                    // Add the boom box
                    loadObj('apartment.obj').then(gltf => {
                        gltf.scene.scale.set(15, 15, 15)
                        gltf.scene.position.set(0, 1, -1.2)
                        gltf.scene.quaternion.setFromAxisAngle(new THREE.Vector3(0, 1, 0), Math.PI)

                        this.floorGroup.add(gltf.scene)
                    }).catch((...params) =>{
                        console.error('could not load gltf', ...params)
                    })
*/
                }
            }


            window.addEventListener('DOMContentLoaded', () => {
                setTimeout(() => {
                    try {
                        window.pageApp = new ARSimplestExample(document.getElementById('target'))
                    } catch(e) {
                        console.error('page error', e)
                    }
                }, 1000)
            })
        </script>
    </body>
</html>
